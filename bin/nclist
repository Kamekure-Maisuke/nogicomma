#!/bin/bash

set -e
export LC_ALL=C

NOGI_INFO_URL="https://ja.wikipedia.org/wiki/%E4%B9%83%E6%9C%A8%E5%9D%8246"
CACHE="$(dirname $0)/../data/"

error_and_usage(){
	echo "usage : ${0##*/}"
	exit 1
}

# 引数1以上はエラー
[ $# -eq 0 ] || error_and_usage

# cacheデータがあれば優先
[ -e "$CACHE" ] && {
	cat $CACHE/member_list
} || {
	curl -s $NOGI_INFO_URL |
	grep -E -B 1 '<td>[ぁ-ん]+ .+</td>' |
	sed -e '/--/d' -e 's/<a href=.\{1,\} title=.\{1,\}">//g' |
	awk -F '[<>]' '
	{
		ORS=(NR%2) ? "\t" : "\n"
		print $3
	}'
}
